

> [!info]
> **Primeira Aula - Introdução ao Power BI**


# 1 - Conceitos Fundamentais de Modelagem

### [Tabelas Fato](https://kb.ufla.br/books/termos-e-definicoes-governanca-de-dados/page/tabela-fato#:~:text=Tabelas%20Fato%20s%C3%A3o%20tabelas%20para,a%20um%20evento%20de%20medi%C3%A7%C3%A3o.)

- Armazena métricas e medidas do negócio
- Contém dados quantitativos e numéricos
- Exemplos: vendas, transações, registros de eventos
- Geralmente possui grande volume de dados

### [Tabelas Dimensão](https://kb.ufla.br/books/termos-e-definicoes-governanca-de-dados/page/tabela-de-dimensao)

- Armazena atributos descritivos
- Fornece contexto para as métricas
- Exemplos: produtos, clientes, fornecedores
- Possui dados mais estáticos e menor volume

> [!example]
> [[2.4.1 - Exemplos BI]]

## 1.1 - Tipos de Modelagem

### 1.1.1 - Modelagem Estrela
- Um modelo centralizado com tabela fato no centro
- Dimensões conectadas diretamente à tabela fato
- Vantagens:
  - Consultas mais rápidas
  - Estrutura mais simples
  - Facilita a compreensão do usuário

### 1.1.2 - Modelagem Snowflake - “Floco de Neve”
- Extensão do modelo estrela
- Dimensões normalizadas em múltiplas tabelas
- Vantagens:
  - Economia de espaço
  - Maior normalização dos dados
  - Melhor para dados muito complexos


## 1.2 - Conceitos de Chaves

### 1.2.1 - Chave Estrangeira
- Campo que cria relacionamento entre tabelas
- Referencia a chave primária de outra tabela
- Fundamental para estabelecer relações no modelo
- Mantém a integridade referencial dos dados

# 2 - Funções de Agregação

## 2.1 - SUM()
- **Descrição**: Soma todos os valores de uma coluna
- **Exemplo básico**: `SUM(Vendas[Valor])`
- **Caso de uso**: 
	- Calcular o total de vendas mensais 
	- Somar todas as despesas de um departamento
- **Observação**: Ignora automaticamente valores nulos ou texto

## 2.2 - SUMX()
- **Descrição**: Soma baseada em uma expressão personalizada
- **Exemplo básico**: `SUMX(Vendas, Vendas[Quantidade] * Vendas[Preço])`
- **Caso de uso**:
	- Calcular faturamento multiplicando quantidade por preço
	- Somar valores com desconto personalizado
- **Observação**: Permite operações mais complexas que SUM()

## 2.3 - COUNT()
- **Descrição**: Conta o número total de linhas em uma coluna
- **Exemplo básico**: `COUNT(Clientes[ID])`
- **Caso de uso**:
	- Contar número total de transações
	- Verificar quantidade de registros em uma tabela
- **Observação**: Inclui valores duplicados na contagem

## 2.4 - DISTINCTCOUNT()
- **Descrição**: Conta valores únicos em uma coluna
- **Exemplo básico**: `DISTINCTCOUNT(Vendas[Cliente])`
- **Caso de uso**:
	- Contar número de clientes únicos
	- Verificar quantidade de produtos diferentes vendidos
- **Observação**: Ignora duplicatas na contagem

## 2.5 - MIN()
- **Descrição**: Retorna o menor valor de uma coluna
- **Exemplo básico**: `MIN(Produtos[Preço])`
- **Caso de uso**:
	- Encontrar o menor preço de um produto
	- Identificar a data mais antiga de um registro
- **Observação**: Considera apenas valores numéricos ou datas

## 2.6 - MAX()
- **Descrição**: Retorna o maior valor de uma coluna
- **Exemplo básico**: `MAX(Funcionários[Salário])`
- **Caso de uso**:
	- Encontrar o maior salário da empresa
	- Identificar a venda de maior valor
- **Observação**: Considera apenas valores numéricos ou datas


# 3 - Funções de Filtro

## 3.1 - FILTER()
- **Descrição**: Função que retorna uma tabela filtrada baseada em condições específicas
- **Exemplo básico**: `FILTER(Vendas, Vendas[Região] = "Norte" && Vendas[Ano] = 2023)`
- **Caso de uso**:
	- Filtrar vendas de uma região específica
	- Selecionar produtos acima de determinado preço
	- Criar subconjuntos de dados para análises específicas
- **Observação**: Pode combinar múltiplas condições usando && (E) e || (OU)

## 3.2 - CALCULATE()
- **Descrição**: Modifica o contexto de filtro de uma medida ou expressão
- **Exemplo básico**: `CALCULATE(SUM(Vendas[Valor]), 
- `Vendas [Ano] = 2023)`
- **Caso de uso**:
	- Calcular vendas totais ignorando filtros existentes
	- Comparar valores entre diferentes períodos
	- Criar cálculos com contextos modificados
- **Observação**: Permite sobrescrever filtros existentes e adicionar novos filtros contextuais
- **Sintaxe avançada**: 
	```
	CALCULATE(
		[Expressão],
		[Filtro1],
		[Filtro2],
		...
	)
	```

> [!example]
> # 4. Exemplos Combinados de Funções DAX
## 4.1 Vendas por Região Acima da Média

```dax
VendasAcimaMedia = 
CALCULATE(
    SUM(Vendas[Valor]),
    FILTER(
        Vendas,
        Vendas[Valor] > CALCULATE(
            AVERAGE(Vendas[Valor])
        )
    )
)
```
- **Explicação**: Combina CALCULATE, SUM, FILTER e AVERAGE
- **Resultado**: Retorna soma das vendas que são maiores que a média geral

## 4.2 Contagem de Clientes VIP por Região

```dax
ClientesVIPRegiao = 
CALCULATE(
    DISTINCTCOUNT(Vendas[Cliente]),
    FILTER(
        Vendas,
        Vendas[ValorTotal] > 
            CALCULATE(
                MAX(Vendas[ValorTotal]) * 0.8
            )
    )
)
```
- **Explicação**: Usa CALCULATE, DISTINCTCOUNT, FILTER e MAX
- **Resultado**: Conta clientes únicos com compras acima de 80% do valor máximo

## 4.3 Média Móvel de Vendas

```dax
MediaMovel3Meses = 
CALCULATE(
    AVERAGE(Vendas[Valor]),
    FILTER(
        ALL(Vendas[Data]),
        Vendas[Data] <= MAX(Vendas[Data]) &&
        Vendas[Data] > EDATE(MAX(Vendas[Data]), -3)
    )
)
```
- **Explicação**: Combina CALCULATE, AVERAGE, FILTER, ALL e funções de data
- **Resultado**: Calcula média dos últimos 3 meses de vendas

## 4.4 Total de Vendas por Categoria Top 5

```dax
VendasTop5Categorias = 
CALCULATE(
    SUMX(
        Vendas,
        Vendas[Quantidade] * Vendas[PrecoUnitario]
    ),
    FILTER(
        ALL(Produtos[Categoria]),
        CALCULATE(
            SUM(Vendas[Valor])
        ) >= CALCULATE(
            SUM(Vendas[Valor]),
            ALL(Produtos[Categoria])
        )
    )
)
```
- **Explicação**: Utiliza CALCULATE, SUMX, FILTER, ALL e SUM
- **Resultado**: Soma vendas apenas das 5 categorias mais vendidas

## 4.5 Crescimento Ano a Ano por Região

```dax
CrescimentoAnual = 
VAR VendasAnoAtual = CALCULATE(
    SUM(Vendas[Valor]),
    FILTER(
        ALL(Vendas[Data]),
        YEAR(Vendas[Data]) = YEAR(MAX(Vendas[Data]))
    )
)
VAR VendasAnoAnterior = CALCULATE(
    SUM(Vendas[Valor]),
    FILTER(
        ALL(Vendas[Data]),
        YEAR(Vendas[Data]) = YEAR(MAX(Vendas[Data])) - 1
    )
)
RETURN
DIVIDE(
    VendasAnoAtual - VendasAnoAnterior,
    VendasAnoAnterior,
    0
)
```
- **Explicação**: Combina VAR, CALCULATE, SUM, FILTER, ALL e funções de data
- **Resultado**: Calcula o percentual de crescimento comparado ao ano anterior